---
title: Журналы планирования проекта
description: Эта статья предоставляет информацию и образцы, которые помогут вам использовать журналы планирования проектов для отслеживания сбоев, связанных со службой планирования проектов и API-интерфейсов планирования проектов.
author: ruhercul
ms.date: 11/30/2021
ms.topic: article
ms.reviewer: johnmichalak
ms.author: ruhercul
ms.openlocfilehash: c57419642e90e4def01f2cd2474c9e82dc162b86
ms.sourcegitcommit: 6cfc50d89528df977a8f6a55c1ad39d99800d9b4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2022
ms.locfileid: "8923711"
---
# <a name="project-scheduling-logs"></a>Журналы планирования проекта

_**Относится к:** Project Operations для сценариев на основе ресурсов/нескладируемых материалов запасов, упрощенное развертывание — от сделки до счетов-проформ_, _Project for the Web_

Microsoft Dynamics 365 Project Operations использует [Project for the Web](https://support.microsoft.com/office/what-is-project-for-the-web-c19b2421-3c9d-4037-97c6-f66b6e1d2eb5) в качестве основного механизма планирования. Вместо использования стандартных интерфейсов программирования веб-приложений (API) Microsoft Dataverse, Project Operations использует новые API-интерфейсы планирования проектов для создания, обновления и удаления задач проекта, назначений ресурсов, зависимостей задач, сегментов проекта и участников проектных групп. Однако, когда операции создания, обновления или удаления программно выполняются для сущностей структурной декомпозиции работ (WBS), могут возникать ошибки. Для отслеживания этих ошибок и истории операций были реализованы два новых административных журнала: **Набор операций** и **Служба планирования проектов (PSS)**. Чтобы получить доступ к этим журналам, перейдите в пункт **Параметры** \> **Интеграция расписаний**.

На следующем рисунке показана модель данных для журналов планирования проектов.

![Модель данных для журналов планирования проектов.](media/LOGDATAMODEL.jpg)

## <a name="operation-set-log"></a>Журнал наборов операций

Журнал набора операций отслеживает выполнение набора операций, который используется для выполнения одной или нескольких операций создания, обновления или удаления в пакетном режиме над проектами, задачами проекта, назначениями ресурсов, зависимостями задач, сегментами проекта или участниками группы проекта. Поле **Операция в состоянии** показывает общий статус набора операций. Подробная информация о полезных данных набора операций фиксируется в связанных записях сведений о наборе операций.

### <a name="operation-set"></a>Набор операций

Следующая таблица содержит поля, которые относятся к сущности **Набор операций**.

| Имя схемы            | Description                                                                                                  | DisplayName            |
|-----------------------|--------------------------------------------------------------------------------------------------------------|------------------------|
| msdyn_completedon     | Дата и время завершения или сбоя набора операций.                                                | Дата выполнения            |
| msdyn_correlationid   | Значение **correlationId** для запроса.                                                                  | CorrelationId          |
| msdyn_description     | Описание набора операций.                                                                        | Description            |
| msdyn_executedon      | Дата и время, когда была выполнена запись.                                                                       | Дата выполнения            |
| msdyn_operationsetId  | Уникальный идентификатор экземпляров сущности.                                                                   | OperationSet           |
| msdyn_Project         | Проект, связанный с набором операций.                                                            | Project                |
| msdyn_projectid       | Значение **projectId** для запроса.                                                                      | ProjectId (устарело) |
| msdyn_projectName     | Не применимо.                                                                                              | Неприменимо         |
| msdyn_PSSErrorLog     | Уникальный идентификатор журнала ошибок службы планирования проектов, связанного с набором операций. | Журнал ошибок PSS          |
| msdyn_PSSErrorLogName | Не применимо.                                                                                              | Неприменимо         |
| msdyn_status          | Состояние набора операций.                                                                             | Status                 |
| msdyn_statusName      | Не применимо.                                                                                              | Неприменимо         |
| msdyn_useraadid       | Код объекта Azure Active Directory (Azure AD) пользователя, которому принадлежит этот запрос.                     | UserAADID              |

### <a name="operation-set-detail"></a>Сведения о наборе операций

Следующая таблица содержит поля, которые относятся к сущности **Сведения о наборе операций**.

| Имя схемы                 | Description                                                                                 | DisplayName           |
|----------------------------|---------------------------------------------------------------------------------------------|-----------------------|
| msdyn_cdspayload           | Сериализованные поля Dataverse для запроса.                                            | CdsPayload            |
| msdyn_entityname           | Имя сущности для этого запроса.                                                     | EntityName            |
| msdyn_httpverb             | Метод запроса.                                                                         | HTTP-команда (устарело) |
| msdyn_httpverbName         | Не применимо.                                                                             | Неприменимо        |
| msdyn_operationset         | Уникальный идентификатор набора операций, к которому относится эта запись.                      | OperationSet          |
| msdyn_operationsetdetailId | Уникальный идентификатор экземпляров сущности.                                                  | Сведения об OperationSet   |
| msdyn_operationsetName     | Не применимо.                                                                             | Неприменимо        |
| msdyn_operationtype        | Тип операции сведений о наборе операций.                                             | Тип операции         |
| msdyn_operationtypeName    | Не применимо.                                                                             | Неприменимо        |
| msdyn_psspayload           | Сериализованные поля службы планирования проектов для запроса.                           | PssPayload            |
| msdyn_recordid             | Идентификатор записи запроса.                                                       | ИД записи             |
| msdyn_requestnumber        | Автоматически созданный номер, идентифицирующий порядок, в котором были получены запросы. | Номер запроса        |

## <a name="project-scheduling-service-error-logs"></a>Журналы ошибок службы планирования проектов

Журналы ошибок службы планирования проектов фиксируют сбои, возникающие, когда служба планирования проектов пытается **Сохранить** или **Открыть** операцию. Эти журналы создаются в трех поддерживаемых сценариях:

- Действия, инициированные пользователем, завершаются критически неудачно (например, невозможно создать назначение из-за отсутствия прав).
- Служба планирования проектов не может программно создавать, обновлять, удалять или выполнять какие-либо другие каскадные операции с сущностью.
- Пользователь сталкивается с ошибками, когда запись не открывается (например, когда открывается проект или обновляется информация об участнике рабочей группы).

### <a name="project-scheduling-service-log"></a>Журнал службы планирования проектов

Следующая таблица содержит поля, которые включены в журнал службы планирования проектов.

| Имя схемы          | Description                                                                    | DisplayName    |
|---------------------|--------------------------------------------------------------------------------|----------------|
| msdyn_CallStack     | Стек вызовов исключения.                                               | Стек вызовов     |
| msdyn_correlationid | Идентификатор корреляции ошибки.                                               | CorrelationId  |
| msdyn_errorcode     | Поле, которое используется для хранения кода ошибки Dataverse или код ошибки HTTP. | Код ошибки     |
| msdyn_HelpLink      | Ссылка на общедоступную справочную документацию.                                       | Ссылка на справку      |
| msdyn_log           | Журнал из службы планирования проектов.                                   | Журнал            |
| msdyn_project       | Проект, связанный с журналом ошибок.                             | Project        |
| msdyn_projectName   | Имя проекта, если полезная нагрузка набора операций будет сохранена. | Неприменимо |
| msdyn_psserrorlogId | Уникальный идентификатор экземпляров сущности.                                     | Журнал ошибок PSS  |
| msdyn_SessionId     | ИД сеанса проекта.                                                        | ИД сеанса     |

## <a name="error-log-cleanup"></a>Очистка журнала ошибок

По умолчанию журналы ошибок службы планирования проектов и журнал набора операций можно очищать каждые 90 дней. Все записи старше 90 дней будут удалены. Однако, изменив значение поля **msdyn_StateOperationSetAge** на странице **Параметры проекта**, администраторы могут настроить диапазон очистки в пределах от 1 до 120 дней. Доступно несколько способов изменения этого значения:

- Настройте сущность **Параметр проекта**, создав настраиваемую страницу и добавив поле **Давность устаревшего набора операций**.
- Используйте клиентский код, который использует [комплект для разработки программного обеспечения (SDK) WebApi](/powerapps/developer/model-driven-apps/clientapi/reference/xrm-webapi/updaterecord).
- Используйте код Service SDK, который использует метод **updateRecord** Xrm SDK (справочник по клиентскому API) в приложениях на основе модели. Power Apps включает описание и поддерживаемые параметры для метода **updateRecord**.

    ```C#
    Xrm.WebApi.retrieveMultipleRecords('msdyn_projectparameter').then(function (response) {
        parameter = response.entities[0];
        var staleOperationValue = prompt("All records older than (x) days will be deleted, please enter X between 1 to 90 days", 1)
        var newData = {};
        newData.msdyn_projectparameterid = parameter.msdyn_projectparameterid;
        newData.msdyn_staleoperationsetage = parseInt(staleOperationValue);
        Xrm.WebApi.updateRecord("msdyn_projectparameter", parameter.msdyn_projectparameterid, newData).then(
            function success(result) {
                console.log("Project Parameter: Stale Operation Expiry is set to: " + newData.msdyn_staleoperationsetage);
                // perform operations on record update
                Xrm.WebApi.retrieveMultipleRecords('msdyn_projectparameter')
                .then(function (response2) { console.log("Confirmed Project Parameter: Stale Operation Expiry is set to: " + response2.entities[0].msdyn_staleoperationsetage) });
            },
            function (error) {
                console.log("Failed to Update Project Ednpoint with error: " + error.message);
            // handle error conditions
            }
        );
    });
    ```
