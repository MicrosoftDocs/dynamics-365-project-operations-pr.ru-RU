---
title: Производительность API планирования проектов
description: Эта тема предоставляет информацию о тестах производительности API-интерфейсов планирования проектов и определяет передовые практики для оптимального использования.
author: ruhercul
ms.date: 11/03/2021
ms.topic: article
ms.reviewer: johnmichalak
ms.author: sigitac
ms.openlocfilehash: 3c14d27c561a86cd359cbdcbb448ae764dd3d90e
ms.sourcegitcommit: c0792bd65d92db25e0e8864879a19c4b93efb10c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2022
ms.locfileid: "8593858"
---
# <a name="project-schedule-api-performance"></a>Производительность API планирования проектов

_**Относится к:** Project Operations для сценариев на основе ресурсов/нескладируемых материалов запасов, упрощенное развертывание — от сделки до счетов-проформ, Project for the Web_

Эта тема предоставляет информацию о тестах производительности API-интерфейсов планирования проектов и определяет передовые практики для оптимизации использования.

## <a name="project-scheduling-service"></a>Служба планирования проектов
Служба планирования проектов — это мультитенантная служба, работающая в Microsoft Azure. Она разработана для улучшения взаимодействия, обеспечивая быстрый и плавный интерфейс при работе пользователей над проектами. Это улучшение достигается за счет приема запросов на изменение, их обработки и немедленного возврата результата. Служба асинхронно сохраняется в Dataverse и не блокирует для пользователей выполнение других операций.

API-интерфейсы планирования проектов полагаются на службу планирования проектов для выполнения запросов, которые более подробно описаны в следующих разделах этой темы.

API-интерфейсы планирования проектов предназначены для работы со следующими сущностями структурной декомпозиции работ (WBS):

  - Project
  - Задача проекта
  - Зависимость задач проекта
  - Участник проектной группы
  - Назначение ресурса
  
Поддерживаются как стандартные, так и настраиваемые поля. Если не указано иное, поддерживаются все обычные операции, такие как создание, обновление и удаление. Для получения дополнительной информации см. раздел [Использование API-интерфейсов планирования проектов для выполнения операций и сущностей планирования](schedule-api-preview.md).

В рамках API-интерфейсов планирования проектов был добавлен шаблон единицы работы. Этот шаблон известен как OperationSet, и его можно использовать, когда несколько запросов должны быть обработаны в одной транзакции.

На следующем рисунке показан поток, с которым партнер столкнется при использовании этой функции.

![Dataverse и поток службы планирования проектов.](./media/dataverse-project-scheduling-service-flow.png)

**Шаг 1**. Клиент выполняет вызов API к конечной точке протокола Open Data Protocol (OData) в Dataverse для создания OperationSet.

**Шаг 2**. После создания нового OperationSet возвращается значение **OperationSetId**.

**Шаг 3**. Клиент использует значение **OperationSetId**, чтобы сделать другой запрос API-интерфейса планирования проектов. Результатом является запрос на создание, обновление или удаление сущности планирования. Когда этот запрос сделан, выполняется проверка метаданных. Если проверка не удалась, запрос прекращается и возвращается ошибка.

**Шаги 4a–4c**. Эти шаги представляют фазу ПРИНЯТЬ. Клиент вызывает API-интерфейс **ExecuteOperationSetV1**, который отправляет все изменения в службу планирования проектов одним пакетом. Служба планирования проектов выполняет собственные проверки запросов в пакете. Любые сбои проверки отменяют пакет и возвращают исключение вызывающей стороне. Если пакет успешно принят службой планирования проектов, статус OperationSet обновляется, чтобы отразить тот факт, что OperationSet обрабатывается службой планирования проектов.

**Шаг 5**. Этот шаг представляет собой фазу СОХРАНЕНИЕ. Служба планирования проектов асинхронно записывает пакет в Dataverse в транзакции. Если операция записи прошла успешно, OperationSet помечается как **Завершено**. Любые ошибки откатывают транзакцию и пакет, а OperationSet помечается как **Неудачно**.

## <a name="performance-methodology"></a>Методология производительности
Время исполнения определяется как время от вызова API-интерфейса **ExecuteOperationSetV1** до момента, когда служба планирования проектов завершает запись в Dataverse. Все операции выполняются в общей сложности 2200 раз, и указывается время выполнения P99. Измеряются операции с одной записью и массовые операции.

Для операции с одной записью OperationSet содержит один запрос. Для массовых операций он содержит 20, 50 или 100 запросов. Каждый размер пакета указывается отдельно.

Эти операции выполняются в развертывании UR 15 Project Operations Lite в Северной Америке.

## <a name="results"></a>Результат
### <a name="create-operations"></a>Создание операций
#### <a name="single-record-create-operations"></a>Операции создания одной записи
В следующей таблице показано время выполнения для создания отдельной записи. Время указано в секундах.

<table class="tg">
<thead>
  <tr>
    <th class="tg-0lax" rowspan="2">Тип&nbsp;&nbsp;&nbsp;записи</th>
    <th class="tg-0lax" colspan="2">Время</th>
  </tr>
  <tr>
    <th class="tg-0lax">Обязательные поля</th>
    <th class="tg-0lax">Все поддерживаемые поля</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">Project</td>
    <td class="tg-0lax">2.5</td>
    <td class="tg-0lax">3.78</td>
  </tr>
  <tr>
    <td class="tg-0lax">Задача</td>
    <td class="tg-0lax">8.82</td>
    <td class="tg-0lax">9.34</td>
  </tr>
  <tr>
    <td class="tg-0lax">Назначение.</td>
    <td class="tg-0lax">9.19</td>
    <td class="tg-0lax">9.19</td>
  </tr>
  <tr>
    <td class="tg-0lax">Участник рабочей группы</td>
    <td class="tg-0lax">0.84</td>
    <td class="tg-0lax">4.2</td>
  </tr>
  <tr>
    <td class="tg-0lax">Зависимость</td>
    <td class="tg-0lax">8.84</td>
    <td class="tg-0lax">8.84</td>
  </tr>
</tbody>
</table>

#### <a name="bulk-create-operations"></a>Операции группового создания
В следующей таблице показано время выполнения для создания нескольких записей. В частности, Microsoft измерила время выполнения для создания 20, 50 и 100 записей в одном OperationSet. Время указано в секундах.

<table class="tg">
<thead>
  <tr>
    <th class="tg-0lax" rowspan="3">Тип&nbsp;&nbsp;&nbsp;записи</th>
    <th class="tg-0lax" colspan="6">Время</th>
  </tr>
  <tr>
    <th class="tg-0lax" colspan="2">20 записей</th>
    <th class="tg-0lax" colspan="2">50 записей</th>
    <th class="tg-0lax" colspan="2">100 записей</th>
  </tr>
  <tr>
    <th class="tg-0lax">Обязательные поля</th>
    <th class="tg-0lax">Все поддерживаемые поля</th>
    <th class="tg-0lax">Обязательные поля</th>
    <th class="tg-0lax">Все поддерживаемые поля</th>
    <th class="tg-0lax">Обязательные поля</th>
    <th class="tg-0lax">Все поддерживаемые поля</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">Задача</td>
    <td class="tg-0lax">19.92</td>
    <td class="tg-0lax">38.35</td>
    <td class="tg-0lax">36.67</td>
    <td class="tg-0lax">99.13</td>
    <td class="tg-0lax">116.77</td>
    <td class="tg-0lax">174.06</td>
  </tr>
  <tr>
    <td class="tg-0lax">Назначение.</td>
    <td class="tg-0lax">13.94</td>
    <td class="tg-0lax">13.94</td>
    <td class="tg-0lax">43.95</td>
    <td class="tg-0lax">43.95</td>
    <td class="tg-0lax">69.38</td>
    <td class="tg-0lax">69.38</td>
  </tr>
  <tr>
    <td class="tg-0lax">Зависимость</td>
    <td class="tg-0lax">30.04</td>
    <td class="tg-0lax">30.04</td>
    <td class="tg-0lax">77.82</td>
    <td class="tg-0lax">77.82</td>
    <td class="tg-0lax">176.89</td>
    <td class="tg-0lax">176.89</td>
  </tr>
</tbody>
</table>

> [!NOTE] 
> Массовые операции создания для сущностей **Проект** и **Участник рабочей группы** не включены в эту таблицу, потому что среда выполнения этих операций напоминает среду выполнения, когда API для создания одной записи вызывается несколько раз. Эти API-интерфейсы запускаются сразу в Dataverse.

На следующем рисунке показан график времени выполнения для сущностей **Задача**, **Назначение** и **Зависимость** при создании 20, 50 и 100 записей и использовании всех поддерживаемых полей.

![График времени выполнения создания записи.](./media/create-record-execution-time.png)

### <a name="update-operations"></a>Операции обновления
#### <a name="single-record-update-operations"></a>Операции обновления одной записи
В следующей таблице показано время выполнения для обновлений отдельной записи. Время указано в секундах.

<table class="tg">
<thead>
  <tr>
    <th class="tg-0lax" rowspan="2">Тип&nbsp;&nbsp;&nbsp;записи</th>
    <th class="tg-0lax" colspan="2">Время</th>
  </tr>
  <tr>
    <th class="tg-0lax">Обязательные поля </th>
    <th class="tg-0lax">Все поддерживаемые поля</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">Project</td>
    <td class="tg-0lax">9.53</td>
    <td class="tg-0lax">13.91</td>
  </tr>
  <tr>
    <td class="tg-0lax">Задача</td>
    <td class="tg-0lax">8.82</td>
    <td class="tg-0lax">9.91</td>
  </tr>
  <tr>
    <td class="tg-0lax">Участник рабочей группы</td>
    <td class="tg-0lax">9</td>
    <td class="tg-0lax">8.96</td>
  </tr>
</tbody>
</table>

> [!NOTE]
> Операции обновления для сущностей **Назначения ресурсов** и **Зависимость задач проекта** не поддерживаются.

#### <a name="bulk-update-operations"></a>Операции группового обновления
В следующей таблице показано время выполнения для обновления нескольких записей. В частности, Microsoft измерила время выполнения для обновления 20, 50 и 100 записей в одном OperationSet. Время указано в секундах.

<table class="tg">
<thead>
  <tr>
    <th class="tg-0lax" rowspan="3">Тип&nbsp;&nbsp;&nbsp;записи</th>
    <th class="tg-0lax" colspan="6">Время</th>
  </tr>
  <tr>
    <th class="tg-0lax" colspan="2">20 записей</th>
    <th class="tg-0lax" colspan="2">50 записей</th>
    <th class="tg-0lax" colspan="2">100 записей</th>
  </tr>
  <tr>
    <th class="tg-0lax">Обязательные поля</th>
    <th class="tg-0lax">Все поддерживаемые поля</th>
    <th class="tg-0lax">Обязательные поля</th>
    <th class="tg-0lax">Все поддерживаемые поля</th>
    <th class="tg-0lax">Обязательные поля</th>
    <th class="tg-0lax">Все поддерживаемые поля</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">Задача</td>
    <td class="tg-0lax">8.91</td>
    <td class="tg-0lax">38.71</td>
    <td class="tg-0lax">20.92</td>
    <td class="tg-0lax">87.13</td>
    <td class="tg-0lax">36.68</td>
    <td class="tg-0lax">190.34</td>
  </tr>
  <tr>
    <td class="tg-0lax">Участник рабочей группы</td>
    <td class="tg-0lax">20.52</td>
    <td class="tg-0lax">26.06</td>
    <td class="tg-0lax">41.93</td>
    <td class="tg-0lax">44.51</td>
    <td class="tg-0lax">38.63</td>
    <td class="tg-0lax">66.53</td>
  </tr>
</tbody>
</table>

> [!NOTE]
> Операции обновления для сущностей **Назначения ресурсов** и **Зависимость задач проекта** не поддерживаются.

На следующем рисунке показан график времени выполнения для сущностей "Задача" и "Участник рабочей группы" при обновлении 20, 50 и 100 записей и использовании всех поддерживаемых полей.

![График времени выполнения обновления записи.](./media/update-record-execution-time.png)

### <a name="delete-operations"></a>Операции удаления
#### <a name="single-record-delete-operations"></a>Операции удаления одной записи
В следующей таблице показано время выполнения для удаления отдельной записи. Время указано в секундах.

| Тип записей | Время  |
|-------------|-------|
| Задача        | 20.12 |
| Назначение.  | 10.86 |
| Участник рабочей группы | 12.52 |
| Зависимость  | 20.89 |

> [!NOTE]
> Операции удаления на сущности **Проект** не поддерживаются.

#### <a name="bulk-delete-operations"></a>Операции группового удаления
В следующей таблице показано время выполнения для удаления нескольких записей. В частности, Microsoft измерила время выполнения для удаления 20, 50 и 100 записей в одном OperationSet. Время указано в секундах.

<table class="tg">
<thead>
  <tr>
    <th class="tg-0lax" rowspan="2">Тип&nbsp;&nbsp;&nbsp;записи</th>
    <th class="tg-0lax" colspan="3">Время</th>
  </tr>
  <tr>
    <th class="tg-0lax">20 записей</th>
    <th class="tg-0lax">50 записей</th>
    <th class="tg-0lax">100 записей</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">Задача</td>
    <td class="tg-0lax">20.91</td>
    <td class="tg-0lax">67.43</td>
    <td class="tg-0lax">71.96</td>
  </tr>
  <tr>
    <td class="tg-0lax">Назначение.</td>
    <td class="tg-0lax">11.75</td>
    <td class="tg-0lax">25.79</td>
    <td class="tg-0lax">47.66</td>
  </tr>
  <tr>
    <td class="tg-0lax">Участник рабочей группы</td>
    <td class="tg-0lax">9.78</td>
    <td class="tg-0lax">39.73</td>
    <td class="tg-0lax">24.33</td>
  </tr>
  <tr>
    <td class="tg-0lax">Зависимость</td>
    <td class="tg-0lax">24.61</td>
    <td class="tg-0lax">54.9</td>
    <td class="tg-0lax">109.16</td>
  </tr>
</tbody>
</table>

> [!NOTE]
> Операции удаления на сущности **Проект** не поддерживаются.

На следующем рисунке показан график времени выполнения для сущностей **Задача**, **Назначение**, **Участник рабочей группы** и **Зависимость** при удалении 20, 50 и 100 записей.

![График времени выполнения удаления записи.](./media/delete-record-execution-time.png)

## <a name="observations"></a>Наблюдения
Для каждой операции записи API-интерфейсу **ExecuteOperationSet** требуется около 800 миллисекунд для отправки запроса в службу планирования проектов. Затем службе планирования проектов требуется около пяти секунд, чтобы обработать полезные данные и вызвать Dataverse. Остальное время выполнения тратится на выполнение бизнес-логики и запись данных в базу данных в формате Dataverse.

Когда создается, обновляется или удаляется 100 записей, API-интерфейс **ExecuteOperationSet** отправляет запрос в службу планирования проектов примерно за три секунды. Затем службе планирования проектов требуется около пяти секунд, чтобы обработать запросы и вызвать Dataverse. Массовые операции должны платить **налог службы планирования проектов** один раз для всех записей в OperationSet. Таким образом, массовые операции имеют значительно меньшее среднее время выполнения, чем операции с одной записью.

## <a name="scenarios"></a>Сценарии
В следующей таблице показаны значения времени выполнения, когда API-интерфейсы планирования проектов используются для выполнения определенных сценариев. Время указано в секундах.

| Сценарий                                                                   | Время  |
|----------------------------------------------------------------------------|-------|
| Создайте проект, состоящий из 40 задач.                                      | 36.01 |
| Создайте проект, состоящий из 40 задач и 20 зависимостей.                  | 38.11 |
| Создайте проект, состоящий из 40 задач и 30 назначений.                   | 60.17 |
| Создайте проект, состоящий из 40 задач, 20 зависимостей и 30 назначений. | 60.27 |

## <a name="best-practices"></a>Рекомендации
Исходя из результатов предыдущего сценария, API-интерфейсы работают лучше в следующих условиях:

  - Сгруппируйте как можно больше операций вместе. Среднее время выполнения для массовых операций лучше, чем среднее время выполнения для операций с одной записью. Чем меньше количество используемых наборов операций OperationSets, тем меньше будет среднее время выполнения.
  - Установите только минимальные атрибуты, необходимые для выполнения вашего сценария. Будьте избирательны в выборе типов необязательных полей, включаемых в запрос OperationSet. Поля, содержащие внешние ключи или поля свертки, будут отрицательно влиять на производительность.
