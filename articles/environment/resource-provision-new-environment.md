---
title: Подготовка новой среды
description: Эта тема предоставляет информацию о подготовке новой среды Project Operations.
author: sigitac
manager: Annbe
ms.date: 10/07/2020
ms.topic: article
ms.service: dynamics-365-customerservice
ms.reviewer: kfend
ms.author: sigitac
ms.openlocfilehash: a43b947207b6d4276ef27ec996713bf3883e7906
ms.sourcegitcommit: 11a61db54119503e82faec5f99c4273e8d1247e5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2020
ms.locfileid: "4083075"
---
# <a name="provision-a-new-environment"></a>Подготовка новой среды

_**Относится к:** Project Operations для сценариев на основе ресурсов/без запасов_

Эта тема предоставляет информацию о том, как подготовить новую среду Dynamics 365 Project Operations для сценариев на основе ресурсов/отсутствия запасов.

## <a name="enable-project-operations-automated-provisioning-in-an-lcs-project"></a>Включение автоматической подготовки Project Operations в проекте LCS

Используйте следующие шаги, чтобы включить поток автоматической подготовки Project Operations для вашего проекта LCS.

1. Перейдите к [LCS](https://lcs.dynamics.com/v2) и выберите плитку **Управление предварительными версиями функций**.
2. В списке **Предварительная версия функции** выберите **Функция Project Operations** и выберите **Предварительная версия функции включена** , чтобы включить Project Operations.

> [!NOTE]
> Этот шаг выполняется только один раз для каждого проекта LCS.

## <a name="provision-a-project-operations-environment"></a>Подготовка среды Project Operations

1. Откройте новую [демонстрационную среду](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/deployment/deploy-demo-environment) Dynamics 365 Finance или развертывание [песочницы/производственной среды](https://docs.microsoft.com/dynamics365/fin-ops-core/dev-itpro/deployment/deployenvironment-newinfrastructure). 
2. Перейдите к мастеру **Подготовка среды**. 

> [!IMPORTANT]
> Убедитесь, что выбрана версия приложения 10.0.13 или выше.

3. Для подготовки Project Operations в разделе **Дополнительные параметры** выберите **Common Data Service**. 
4. Включите параметр **Настройка Common Data Service** , выбрав **Да** , затем введите информацию в обязательные поля:

  - Название
  - Область
  - Язык
  - Валюта
 
5. В поле **Шаблон Common Data Service** выберите **Project Operations** 

6. Выберите тип среды для вашего развертывания. Пробная версия на основе подписки позволит вам развернуть среду CDS на 30 дней. 

![Параметры развертывания](./media/1DeploymentSettings.png)

> [!IMPORTANT]
> Выберите **Принимаю** , чтобы подтвердить условия использования, затем выберите **Готово** , чтобы вернуться к настройкам развертывания.

![Согласие на развертывание](./media/2DeploymentConsent.png)

7. Заполните оставшиеся обязательные поля в мастере и подтвердите развертывание. Время подготовки среды зависит от типа среды. Подготовка может занять до шести часов.

  После успешного завершения развертывания среда будет отображаться как **Развернуто**.

8. Чтобы убедиться, что среда успешно развернута, выберите **Войти** и войдите в среду для подтверждения.

![Сведения о среде ](./media/3EnvironmentDetails.png)

## <a name="apply-project-operations-finance-demo-data-optional-step"></a>Применение демонстрационных данных Project Operations Finance (необязательный шаг)

Примените демонстрационные данные Project Operations Finance к размещенной в облаке среде выпуска службы 10.0.13, как описано в [этой статье](resource-apply-finance-demo-data.md).

## <a name="apply-updates-to-the-finance-environment"></a>Применение обновлений к среде Finance

Для Project Operations требуется среда Finance с версией приложения **10.0.13 (10.0.569.20009)** или выше.

Для получения этой версии вам может потребоваться применить качественные обновления к вашей среде Finance.

1. В LCS на странице **Сведения о среде** в разделе **Доступные обновления** выберите **Посмотреть обновление**.

![Просмотр обновлений](./media/5ViewUpdates.png)

2. На странице **Двоичные обновления** выберите **Сохранить пакет.**

![Сохранить пакет](./media/6SavePackage.png)

3. Выберите **Сохранить все** и затем выберите **Сохранить пакет**.

![Просмотр и сохранение обновлений](./media/7ReviewAndSaveUpdates.png)

4. Введите имя и описание пакета, затем выберите **Сохранить**. В зависимости от подключения к Интернету этот процесс может занять некоторое время.

![Отправка пакета в библиотеку ресурсов](./media/8UploadPackageToAssetsLibrary.png)

5. После сохранения пакета выберите **Готово** и сохраните этот пакет в библиотеке ресурсов вашего проекта LCS.

Сохранение и проверка пакета может занять около 15 минут.

6. Чтобы применить обновление, перейдите на страницу **Сведения о среде** в LCS и выберите **Ведение** > **Применить обновления**.

![Ведение сред](./media/9MaintainEnvironment.png)

7. В списке обновлений выберите созданный вами пакет и выберите **Применять**.

![Применить обновления](./media/10ApplyUpdates.png)

Обслуживание среды займет некоторое время. После его завершения среда вернется в развернутое состояние.

![Среда развернута](./media/11EnvironmentDeployed.png)

## <a name="establish-a-dual-write-connection"></a>Установка соединения с двойной записью 

1. В своем проекте LCS перейдите на страницу **Сведения о среде**.
2. В разделе **Сведения о среде Common Data Service** выберите **Ссылка на CDS для приложений**.
3. После создания ссылки снова выберите **Ссылка на CDS для приложений**. Вы будете перенаправлены на страницу двойной записи в Finance.

![Связь с CDS](./media/12LinktoCDS.png)

4. Выберите **Применить решение** для доступа к сущностям, которые будут сопоставлены при интеграции.

![Применение решений](./media/13ApplySolutions.png)

5. Выберите оба решения, **Сопоставление сущностей двойной записи Dynamics 365 Finance and Operations** и **Сопоставления сущностей двойной записи Dynamics 365 Project Operations** , затем выберите **Применить**.

![Подтверждение решений](./media/14ConfirmSolutions.png)

После применения решений к среде применяются сущности двойной записи.

![Применение решений](./media/15ApplyingSolutions.png)

После применения сущностей все доступные сопоставления перечислены в среде.

![Сопоставления двойной записи](./media/15DWMappings.png)

## <a name="refresh-the-data-entities-after-the-update"></a>Обновление сущностей данных после обновления

1. В Finance перейдите в рабочую область **Управление данными**.

![Рабочая область управления данными](./media/16DataManagement.png)

2. Выберите плитку **Параметры структуры**.

![Параметры структуры](./media/17FrameworkParameters.png)

3. На странице **Параметры сущности** выберите **Обновить список сущностей**.

![Обновление списка сущностей](./media/18RefreshEntityList.png)

Обновление займет около 20 минут. Вы получите уведомление, когда оно будет завершено.

![Подтверждение обновления](./media/19RefreshConfirmation.png)

## <a name="run-project-operations-dual-write-maps"></a>Запуск сопоставлений двойной записи Project Operations

1. В своем проекте LCS перейдите на страницу **Сведения о среде**.
2. В разделе **Сведения о среде Common Data Service** выберите **Ссылка на CDS для приложений.** После выбора ссылки вы будете перенаправлены к списку сущностей в сопоставлениях.
3. Запустите сопоставления, как описано в следующей таблице. Убедитесь, что вы соблюдаете указанную последовательность.

| **Сопоставление сущностей** | **Обновление сущности** | **Начальная синхронизация** | **Главный объект для начальной синхронизации** | **Выполнение необходимых условий** | **Начальная синхронизация необходимых условий** |
| --- | --- | --- | --- | --- | --- |
| **Роли ресурсов проекта для всех компаний (bookableresourcecategories)** | No | Да | Common Data Service | No | Неприменимо |
| **Юридические лица (cdm\_companies)** | No | Да | Приложения Finance and Operations | No | Неприменимо |
| **Фактические данные интеграции Project Operations (msdyn\_actuals)** | No | No | Неприменимо | Да | No |
| **Строки контракта по проекту (salesorderdetails)** | No | No | Неприменимо | No | No |
| **Сущность интеграции для отношений транзакций проекта (msdyn\_transactionconnections)** | No | No | Неприменимо | No | Неприменимо |
| **Основные этапы строки контракта интеграции Project Operations (msdyn\_contractlinesscheduleofvalues)** | No | No | Неприменимо | No | Неприменимо |
| **Сущность интеграции Project Operations для оценки расходов (msdyn\_estimateslines)** | No | No | Неприменимо | No | Неприменимо |
| **Сущность экспорта категорий расходов проекта интеграции Project Operations (msdyn\_expensecategories)** | No | No | Неприменимо | No | Неприменимо |
| **Сущность экспорта расходов проекта интеграции Project Operations (msdyn\_expenses)** | Да | No | Неприменимо | No | Неприменимо |
| **Сущность интеграции Project Operations для оценки часов (msdyn\_resourceassignments)** | Да | No | Неприменимо | No | Неприменимо |


4. Чтобы обновить сущность, выберите имя сопоставления, затем выберите **Обновить сущности**. 


![Обновление сопоставления](./media/20RefreshMapping.png)

5. После завершения обновления запустите сопоставление. Прежде чем включить следующее сопоставление, убедитесь, что сопоставление в таблице находится в состоянии **Запущено**. Запуск сопоставлений с большим количеством предварительных условий может занять некоторое время.

Чтобы запустить сопоставление с предварительными условиями, включите переключатель **Показать связанные сопоставления сущностей**. Если в таблице указано, что **Начальная синхронизация необходимых условий** имеет значение **Нет** , убедитесь, что флаг **Начальная синхронизация** имеет значение **Откл.** на всех сопоставления необходимых условий перед их запуском.

![Запуск сопоставления](./media/21RunMap.png)

6. Убедитесь, что все связанные с проектом сопоставления находятся в рабочем состоянии.

![Все сопоставления работают](./media/22AllMapsRunning.png)

Теперь ваша среда Project Operations подготовлена и настроена.
