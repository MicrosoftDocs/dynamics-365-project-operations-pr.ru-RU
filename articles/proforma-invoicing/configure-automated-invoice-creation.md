---
title: Настройка автоматического создания счетов
description: Эта тема предоставляет информацию о том, как настроить систему для автоматического создания счетов.
author: rumant
manager: AnnBe
ms.date: 09/18/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-customerservice
ms.technology: ''
audience: Application User
ms.reviewer: kfend
ms.search.scope: ''
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Service industries
ms.author: suvaidya
ms.dyn365.ops.version: ''
ms.search.validFrom: 2020-10-01
ms.openlocfilehash: 764fd4568619e4f5676ee3cbf7fce14ffb069548
ms.sourcegitcommit: a2c3cd49a3b667b8b5edaa31788b4b9b1f728d78
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/28/2020
ms.locfileid: "3898142"
---
# <a name="configure-automated-invoice-creation"></a>Настройка автоматического создания счетов

_**Относится к:** Project Operations для сценариев на основе ресурсов/нескладируемых запасов, упрощенное развертывание — от сделки до выставления счетов-фактур_

Выполните следующие шаги, чтобы настроить автоматический запуск счетов в Project Operations.

1. Перейдите в раздел **Параметры** \> **Пакетные задания**.
2. Создайте пакетное задание и назовите его **Создание счетов в Project Operations**. Имя пакетного задания должно включать термин "создание счетов".
3. В поле **Тип задания** выберите **Нет**. По умолчанию для параметров **Частота ежедневно** и **Активно** задано значение **Да**.
4. Выберите **Запустить рабочий процесс**. В диалоговом окне **Поиск в записях** отображаются три рабочих процесса:

    - ProcessRunCaller
    - ProcessRunner
    - UpdateRoleUtilization

5. Выберите **ProcessRunCaller**, затем выберите **Добавить**.
6. В следующем диалоговом окне выберите **ОК**. За рабочим процессом **Сон** следует рабочий процесс **Обработка**.

    Можно также выбрать **ProcessRunner** на шаге 5. Затем при выборе **OK** за рабочим процессом **Обработка** следует рабочий процесс **Сон**.

Рабочие процессы **ProcessRunCaller** и **ProcessRunner** создают счета. **ProcessRunCaller** вызывает **ProcessRunner**. Счета фактически создаются рабочим процессом **ProcessRunner**. Он перебирает все строки контракта, для которых должны быть созданы счета, и создает счета для этих строк. Чтобы определить строки контракта, для которых должны быть созданы счета, задание проверяет даты запуска счетов для строк контракта. Если строки контракта, принадлежащие к одному контракту, имеют одинаковую дату запуска счета, транзакции объединяются в один счет с двумя строками счета. Если транзакции, для которых требуется создать счета, отсутствуют, задание пропускает создание счета.

После завершения работы **ProcessRunner** он вызывает **ProcessRunCaller**, предоставляет время завершения и закрывается. **ProcessRunCaller** затем запускает таймер, который работает 24 часа с указанного времени завершения. По завершении работы таймера процесс **ProcessRunCaller** закрывается.

Задание пакетной обработки для создания счетов — это повторяющееся задание. Если это процесс пакетной обработки запускается много раз, создается несколько экземпляров задания, что вызывает ошибки. Следовательно, необходимо запустить пакетный процесс только один раз, и заново запускать его следует только в том случае, если он перестал работать.

> [!NOTE]
> Пакетное выставление счетов запускается только для строк контракта по проекту, которые настроены с помощью графиков счетов. В строке контракта с методом выставления счетов с фиксированной ценой должны быть настроены вехи. Для строки контракта по проекту с методом выставления счетов с учетом времени и материала потребуется настроить расписание счетов на основе даты. То же самое справедливо для строки контракта на основе проекта.     
