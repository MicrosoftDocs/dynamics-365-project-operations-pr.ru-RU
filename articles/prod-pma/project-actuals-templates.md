---
title: Синхронизируйте фактические данные по проекту непосредственно из Project Service Automation с журналом интеграции проекта для разноски в Finance and Operations
description: В этой теме описаны шаблоны и базовые задачи, которые используются для синхронизации фактических данных проекта непосредственно из Microsoft Dynamics 365 Project Service Automation с Finance and Operations.
author: Yowelle
ms.date: 07/20/2018
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 87983
ms.assetid: b454ad57-2fd6-46c9-a77e-646de4153067
ms.search.region: Global
ms.author: andchoi
ms.search.validFrom: 2016-11-28
ms.dyn365.ops.version: AX 7.3.0
ms.openlocfilehash: db63413456e4b91d308af9c1103000d5cdc693f7
ms.sourcegitcommit: 40f68387f594180af64a5e5c748b6efa188bd300
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2021
ms.locfileid: "5999912"
---
# <a name="synchronize-project-actuals-directly-from-project-service-automation-to-the-project-integration-journal-for-posting-in-finance-and-operations"></a>Синхронизируйте фактические данные по проекту непосредственно из Project Service Automation с журналом интеграции проекта для разноски в Finance and Operations

[!include[banner](../includes/banner.md)]

В этой теме описаны шаблоны и базовые задачи, которые используются для синхронизации фактических данных проекта непосредственно из Dynamics 365 Project Service Automation с Dynamics 365 Finance.

Шаблон синхронизирует транзакции из Project Service Automation с промежуточной таблицей в Finance. После завершения синхронизации вы **должны** импортировать данные из промежуточной таблицы в журнал интеграции.

> [!NOTE]
> - Интеграция фактических данных по проекту доступна с версии 8.0.1.
> - Если вы используете версию Enterprise Edition 7.3.0 после установки KB 4132657 и KB 4132660, вы сможете использовать шаблоны для интеграции задач проекта, категорий транзакций расходов, часовых оценок, оценок расходов и фактических данных, а также для настройки блокировки функций. Если вам необходимо сбросить распределения по счетам, мы рекомендуем также установить KB 4131710.
> - Если вы используете версию 7.3.0 и переносите транзакции сборов из Project Service Automation, вы должны установить KB 4345320, чтобы включить эти сборы в счет проекта.
> - Если вы вводите суммы налога с продаж вовремя или транзакции расходов в Project Service Automation, вам необходимо установить Project Service Automation Update 7. В противном случае фактические налоговые данные не будут связаны с соответствующими фактическими затратами времени или расходов и не будут синхронизированы с Finance. Для получения дополнительных сведений обращайтесь в службу поддержки.

## <a name="data-flow-for-project-service-automation-to-finance"></a>Поток данных для Project Service Automation в Finance

Решение для интеграции Project Service Automation в Finance использует функцию интеграции данных для синхронизации данных между экземплярами Project Service Automation и Finance. Шаблоны интеграции, доступные с функцией интеграции данных, позволяют передавать данные о фактических данных проекта из Project Service Automation в FInance.

На следующем рисунке показано, как данные синхронизируются между Project Service Automation и Finance.

[![Поток данных для интеграции Project Service Automation с Finance and Operations](./media/ProjectActualsFlow.jpg)](./media/ProjectActualsFlow.jpg)

## <a name="project-actuals-from-project-service-automation"></a>Фактические данные проекта из Project Service Automation

### <a name="template-and-tasks"></a>Шаблон и задачи

Чтобы получить доступ к доступным шаблонам, в центре администрирования Microsoft Power Apps выберите **Проекты**, а затем в правом верхнем углу выберите **Создать проект** для выбора общедоступных шаблонов.

Следующий шаблон и базовые задачи используются для синхронизации фактических данных по проекту из Project Service Automation в Finance:

- **Название шаблона в интеграции данных:** Фактические данные по проекту (из PSA в Fin and Ops)
- **Название задач в проекте:**

    - Фактические значения
    - TransactionConnections

### <a name="entity-set"></a>Набор сущностей

| Project Service Automation | Финансы                                   |
|----------------------------|----------------------------------------------------------|
| Фактические значения                    | Сущность интеграции для фактических данных проекта                   |
| Подключения проводки    | Сущность интеграции для отношений транзакций проекта |

### <a name="entity-flow"></a>Поток сущностей

Фактические данные по проекту управляются в Project Service Automation и синхронизируются с журналом интеграции проекта в Finance. Учет будет применяться на основе финансовых аналитик по умолчанию и настройки разноски.

### <a name="prerequisites"></a>Предварительные условия

Перед синхронизацией фактических данных необходимо настроить параметры интеграции Project Service Automation и синхронизировать проекты, задачи проекта и категории транзакций расходов по проекту.

### <a name="power-query"></a>Power Query

В шаблоне фактических данных по проекту необходимо использовать Microsoft Power Query для Excel для выполнения следующих задач:

- Преобразуйте тип транзакции в Project Service Automation в правильный тип транзакции в Finance. Это преобразование уже определено в шаблоне фактических данных проекта (из PSA в Fin and Ops).
- Преобразуйте тип выставления счетов в Project Service Automation в правильный тип выставления счетов в Finance. Это преобразование уже определено в шаблоне фактических данных проекта (из PSA в Fin and Ops). Затем тип выставления счетов сопоставляется со свойством строки на основе конфигурации на странице **Параметры интеграции Project Service Automation**.
- Отфильтруйте определенные подразделения ресурса, которые необходимо синхронизировать с этим шаблоном.
- Если внутрихолдинговое время или фактические данные внутрихолдинговых расходов будут синхронизированы с Finance, необходимо преобразовать подразделение контракта в правильное юридическое лицо в Finance. В шаблоне фактических данных проекта (из PSA в Fin and Ops) условный столбец определяется на основе демонстрационных данных. Вы должны обновить последний вставленный условный столбец, указав правильные юридические лица. В противном случае может произойти ошибка интеграции или неправильные фактические транзакции могут быть импортированы в Finance.
- Если внутрихолдинговое время или фактические данные внутрихолдинговых расходов не синхронизируются с Finance, необходимо удалить последний вставленный условный столбец из шаблона. В противном случае может произойти ошибка интеграции или неправильные фактические транзакции могут быть импортированы в Finance.

#### <a name="contract-organizational-unit"></a>Подразделение контракта
Чтобы обновить вставленный условный столбец в шаблоне, щелкните стрелку **Сопоставить**, чтобы открыть сопоставление. Выберите ссылку **Расширенный запрос и фильтрация** для открытия Power Query.

- Если вы используете шаблон фактических данных проекта по умолчанию (PSA в Fin and Ops), в Power Query выберите последнее **Вставленное условие** в разделе **Примененные шаги**. В записи **Функция** замените **USSI** на название юридического лица, которое следует использовать при интеграции. Добавьте дополнительные условия в запись **Функция**, как вам нужно, и обновите условие **else** **USMF** на правильное юридическое лицо.
- Если вы создаете новый шаблон, вы должны добавить столбец для поддержки времени и затрат внутри компании. Выберите **Добавить условный столбец** и введите имя столбца, например **LegalEntity**. Введите условие для столбца, где if **msdyn\_contractorganizationalunitid.msdyn\_name** is \<organizational unit\>, then \<enter the legal entity\>; else null.

### <a name="template-mapping-in-data-integration"></a>Сопоставление шаблонов в интеграции данных

На следующих рисунках показан пример сопоставления задач шаблона в интеграции данных. В сопоставлении отображается информация о полях, которые будут синхронизированы из Project Service Automation в Finance.

[![Сопоставление шаблонов — фактические данные](./media/ActualsMapping.jpg)](./media/ActualsMapping.jpg)

[![Сопоставление шаблонов — транзакционные соединения](./media/TransactionConnections.jpg)](./media/TransactionConnections.jpg)

## <a name="import-from-staging-table-after-integration-from-project-service-automation"></a>Импорт из промежуточной таблицы после интеграции из Project Service Automation

Периодический процесс импорта из промежуточной таблицы должен запускаться после синхронизации фактических данных из Project Service Automation в Finance. Этот процесс импортирует транзакции проекта из промежуточной таблицы в журнал интеграции Project Service Automation, где применяется учет и можно разнести импортированные транзакции. Мы рекомендуем запускать этот процесс в пакетном режиме; при желании его можно настроить для работы в виде повторяющегося пакета.

## <a name="update-actuals-from-finance"></a>Обновление фактических данных из Finance

### <a name="template-and-tasks"></a>Шаблон и задачи

Следующий шаблон и базовые задачи используются для синхронизации номера ваучера и налогов с продаж для разнесенных транзакций проекта из Finance в Project Service Automation:

- **Название шаблона в интеграции данных:** Обновление фактических данных по проекту (из Fin and Ops в PSA)
- **Название задач в проекте:**

    - Фактические значения 
    - TransactionConnections

### <a name="entity-set"></a>Набор сущностей

| Финансы                                                  | Project Service Automation |
|----------------------------------------------------------|----------------------------|
| Сущность интеграции для фактических данных проекта                   | Фактические значения                    |
| Сущность интеграции для отношений транзакций проекта | Подключения проводки    |

### <a name="entity-flow"></a>Поток сущностей

Фактические данные по проекту управляются в Project Service Automation и синхронизируются с журналом интеграции проекта в Finance. После публикации фактических данных в Finance они обновляются в Project Service Automation на номер ваучера из Finance. Если налоги с продаж были добавлены в Finance, новые фактические налоги создаются в Project Service Automation.

### <a name="power-query"></a>Power Query

В шаблоне обновления фактических данных по проекту необходимо использовать Power Query для выполнения следующих задач:

- Преобразуйте тип транзакции в Finance в правильный тип транзакции в Project Service Automation. Это преобразование уже определено в шаблоне обновления фактических данных проекта (из Fin and Ops в PSA).
- Преобразуйте тип выставления счетов в Finance в правильный тип выставления счетов в Project Service Automation. Это преобразование уже определено в шаблоне обновления фактических данных проекта (из Fin and Ops в PSA).

### <a name="template-mapping-in-data-integration"></a>Сопоставление шаблонов в интеграции данных

На следующих рисунках показаны примеры сопоставлений задач шаблона в интеграции данных. В сопоставлении отображается информация о полях, которые будут синхронизированы из Finance в Project Service Automation.

[![Сопоставление шаблонов — обновление фактических данных](./media/ActualsUpdateMapping.jpg)](./media/ActualsUpdateMapping.jpg)

[![Сопоставление шаблонов — обновление транзакций](./media/TransactionConnectionsUpdate.jpg)](./media/TransactionConnectionsUpdate.jpg)


[!INCLUDE[footer-include](../includes/footer-banner.md)]