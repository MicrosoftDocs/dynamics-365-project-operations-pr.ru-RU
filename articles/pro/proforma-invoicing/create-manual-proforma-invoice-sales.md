---
title: Счета-проформы по проекту
description: В этой теме содержится информация о счетах-проформах по проекту в Project Operations.
author: rumant
ms.date: 04/06/2021
ms.topic: article
ms.prod: ''
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 1b839c3e40ddcfe1f07b0330a78c42851140d4bf
ms.sourcegitcommit: 40f68387f594180af64a5e5c748b6efa188bd300
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2021
ms.locfileid: "6004052"
---
# <a name="proforma-project-pnvoices"></a><span data-ttu-id="386af-103">Счета-проформы по проекту</span><span class="sxs-lookup"><span data-stu-id="386af-103">Proforma project pnvoices</span></span>

<span data-ttu-id="386af-104">_**Относится к:** развертывание Lite — от сделки до счетов-проформ_</span><span class="sxs-lookup"><span data-stu-id="386af-104">_**Applies To:** Lite deployment - deal to proforma invoicing_</span></span>

<span data-ttu-id="386af-105">Выставление счетов-проформы по проекту дает руководителям проекта второй уровень утверждения перед созданием счетов для клиентов.</span><span class="sxs-lookup"><span data-stu-id="386af-105">Proforma project invoicing gives project managers a second level of approval before they create invoices for customers.</span></span> <span data-ttu-id="386af-106">Первый уровень утверждения завершается, когда утверждаются записи времени, расходов и материалов, представленные участниками проектной группы.</span><span class="sxs-lookup"><span data-stu-id="386af-106">The first level of approval is completed when time, expense, and material entries that project team members submit are approved.</span></span>

<span data-ttu-id="386af-107">Dynamics 365 Project Operations Lite Deployment не предназначено для создания счетов для клиентов.</span><span class="sxs-lookup"><span data-stu-id="386af-107">Dynamics 365 Project Operations Lite Deployment isn't designed to generate customer-facing invoices.</span></span> <span data-ttu-id="386af-108">В следующем списке показано, почему не могут быть созданы счета:</span><span class="sxs-lookup"><span data-stu-id="386af-108">The following list shows why invoices cannot be generated:</span></span>

- <span data-ttu-id="386af-109">Не содержит данные о налогах.</span><span class="sxs-lookup"><span data-stu-id="386af-109">Does not contain tax information.</span></span>
- <span data-ttu-id="386af-110">Невозможно конвертировать другие валюты в валюту выставления счета.</span><span class="sxs-lookup"><span data-stu-id="386af-110">Cannot convert other currencies to the invoicing currency.</span></span>
- <span data-ttu-id="386af-111">Невозможно правильно отформатировать счета для печати.</span><span class="sxs-lookup"><span data-stu-id="386af-111">Cannot correctly format invoices for printing.</span></span>

<span data-ttu-id="386af-112">Вместо этого можно использовать финансовую или бухгалтерскую систему для создания счетов для клиентов, которые используют данные из созданных предложений счета.</span><span class="sxs-lookup"><span data-stu-id="386af-112">Instead, you can use a financial or accounting system to create customer-facing invoices that use the information in generated invoice proposals.</span></span>

## <a name="creating-project-invoices"></a><span data-ttu-id="386af-113">Создание счетов по проекту</span><span class="sxs-lookup"><span data-stu-id="386af-113">Creating project invoices</span></span>

<span data-ttu-id="386af-114">Счета проекта можно создавать по отдельности или массово.</span><span class="sxs-lookup"><span data-stu-id="386af-114">Project invoices can be created one at a time or in bulk.</span></span> <span data-ttu-id="386af-115">Можно создавать их вручную или можно настроить таким образом, чтобы они создавались в автоматизированных прогонах.</span><span class="sxs-lookup"><span data-stu-id="386af-115">You can create them manually, or they can be configured so that they are generated in automated runs.</span></span>

### <a name="manually-create-project-invoices"></a><span data-ttu-id="386af-116">Создание счетов проекта вручную</span><span class="sxs-lookup"><span data-stu-id="386af-116">Manually create project invoices</span></span> 

<span data-ttu-id="386af-117">На странице списка **Контракты по проекту** можно создать счета по проекту отдельно для каждого контракта по проекту или можно создать счета пакетом для нескольких контрактов по проекту.</span><span class="sxs-lookup"><span data-stu-id="386af-117">On the **Project Contracts** list page, you can create project invoices separately for each project contract, or you can create invoices in bulk for multiple project contracts.</span></span>

   - <span data-ttu-id="386af-118">Чтобы создать счет для конкретного контракта проекта, на странице списка **Контракты по проекту** откройте контракт по проекту, затем выберите **Создать счет**.</span><span class="sxs-lookup"><span data-stu-id="386af-118">To create an invoice for a specific project contract, on the **Project Contracts** list page, open a project contract, and then select **Create Invoice**.</span></span>

   <span data-ttu-id="386af-119">Счет создается для всех транзакций для выбранного контракта по проекту с состоянием **Готово к выставлению счета**.</span><span class="sxs-lookup"><span data-stu-id="386af-119">An invoice is generated for all transactions for the selected project contract that have a status of **Ready to Invoice**.</span></span> <span data-ttu-id="386af-120">Эти транзакции включают в себя время, расходы, материалы, вехи, строки контрактов на основе продуктов и другие строки журнала продаж без выставленных счетов, которые могли быть подтверждены.</span><span class="sxs-lookup"><span data-stu-id="386af-120">These transactions include time, expenses, materials, milestones, product-based contract lines, and other unbilled sales journal lines that may have been confirmed.</span></span>

<span data-ttu-id="386af-121">Для массового создания счетов:</span><span class="sxs-lookup"><span data-stu-id="386af-121">To create invoices in bulk:</span></span>

1. <span data-ttu-id="386af-122">На странице списка **Контракты по проекту** выберите один или несколько контрактов по проекту, для которых необходимо создать счет, затем выберите **Создать счета проекта**.</span><span class="sxs-lookup"><span data-stu-id="386af-122">On the **Project Contracts** list page, select one or more project contracts to create an invoice for, and then select **Create Project Invoices**.</span></span>
2. <span data-ttu-id="386af-123">Предупреждение информирует, что может быть задержка до того, как счета будут созданы.</span><span class="sxs-lookup"><span data-stu-id="386af-123">A warning message informs you that there might be a delay before invoices are created.</span></span> <span data-ttu-id="386af-124">Ход выполнения также отображается.</span><span class="sxs-lookup"><span data-stu-id="386af-124">The process is also shown.</span></span> <span data-ttu-id="386af-125">Выберите **ОК**, чтобы закрыть окно сообщения.</span><span class="sxs-lookup"><span data-stu-id="386af-125">Select **OK** to close the message box.</span></span>

   <span data-ttu-id="386af-126">Счет создается для всех транзакций по строке контракта с состоянием **Готово к выставлению счета**.</span><span class="sxs-lookup"><span data-stu-id="386af-126">An invoice is generated for all transactions on a contract line that have a status of **Ready to Invoice**.</span></span> <span data-ttu-id="386af-127">Эти транзакции включают в себя время, расходы, материалы, вехи, строки контрактов на основе продуктов и другие строки журнала продаж без выставленных счетов, которые могли быть подтверждены.</span><span class="sxs-lookup"><span data-stu-id="386af-127">These transactions include time, expenses, materials, milestones, product - based contract lines and other unbilled sales journal lines that may have been confirmed.</span></span>

3. <span data-ttu-id="386af-128">Для просмотра созданных счетов выберите **Продажи** \> **Выставление счетов** \> **Счета**.</span><span class="sxs-lookup"><span data-stu-id="386af-128">View the invoices that are generated by going to **Sales** \> **Billing** \> **Invoices**.</span></span> <span data-ttu-id="386af-129">Вы увидите по одному счету для каждого контракта по проекту.</span><span class="sxs-lookup"><span data-stu-id="386af-129">You will see one invoice for each project contract.</span></span>

### <a name="set-up-automated-creation-of-project-invoices"></a><span data-ttu-id="386af-130">Настройка автоматизированного создания счетов по проекту</span><span class="sxs-lookup"><span data-stu-id="386af-130">Set up automated creation of project invoices</span></span> 

<span data-ttu-id="386af-131">Выполните следующие шаги для настройки автоматического запуска выставления счетов.</span><span class="sxs-lookup"><span data-stu-id="386af-131">Follow these steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="386af-132">Перейдите в раздел **Параметры** \> **Пакетные задания**.</span><span class="sxs-lookup"><span data-stu-id="386af-132">Go to **Settings** \> **Batch jobs**.</span></span>
2. <span data-ttu-id="386af-133">Создайте пакетное задание и назовите его **Создание счетов в Project Operations**.</span><span class="sxs-lookup"><span data-stu-id="386af-133">Create a batch job, and name it **Project Operations Create Invoices**.</span></span> <span data-ttu-id="386af-134">Имя пакетного задания должно включать термин "Создание счетов".</span><span class="sxs-lookup"><span data-stu-id="386af-134">The name of the batch job must include the term "Create Invoices."</span></span>
3. <span data-ttu-id="386af-135">В поле **Тип задания** выберите **Нет**.</span><span class="sxs-lookup"><span data-stu-id="386af-135">In the **Job type** field, select **None**.</span></span> <span data-ttu-id="386af-136">По умолчанию для параметров **Частота ежедневно** и **Активно** задано значение **Да**.</span><span class="sxs-lookup"><span data-stu-id="386af-136">By default, the **Frequency Daily** and **Is Active** options are set to **Yes**.</span></span>
4. <span data-ttu-id="386af-137">Выберите **Запустить рабочий процесс**.</span><span class="sxs-lookup"><span data-stu-id="386af-137">Select **Run Workflow**.</span></span> <span data-ttu-id="386af-138">В диалоговом окне **Поиск в записях** отображаются следующие рабочие процессы:</span><span class="sxs-lookup"><span data-stu-id="386af-138">In the **Look Up Record** dialog box, you will see the following workflows:</span></span>

    - <span data-ttu-id="386af-139">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="386af-139">ProcessRunCaller</span></span>
    - <span data-ttu-id="386af-140">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="386af-140">ProcessRunner</span></span>
    - <span data-ttu-id="386af-141">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="386af-141">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="386af-142">Выберите **ProcessRunCaller**, затем выберите **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="386af-142">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="386af-143">В следующем диалоговом окне выберите **ОК**.</span><span class="sxs-lookup"><span data-stu-id="386af-143">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="386af-144">За рабочим процессом **Сон** следует рабочий процесс **Обработка**.</span><span class="sxs-lookup"><span data-stu-id="386af-144">A **Sleep** workflow is followed by a **Process** workflow.</span></span>

    <span data-ttu-id="386af-145">Можно также выбрать **ProcessRunner** на шаге 5.</span><span class="sxs-lookup"><span data-stu-id="386af-145">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="386af-146">Затем при выборе **OK** за рабочим процессом **Обработка** следует рабочий процесс **Сон**.</span><span class="sxs-lookup"><span data-stu-id="386af-146">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="386af-147">Рабочие процессы **ProcessRunCaller** и **ProcessRunner** создают счета.</span><span class="sxs-lookup"><span data-stu-id="386af-147">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="386af-148">**ProcessRunCaller** вызывает **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="386af-148">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="386af-149">Счета создаются рабочим процессом **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="386af-149">**ProcessRunner** is the workflow that creates the invoices.</span></span> <span data-ttu-id="386af-150">Этот рабочий процесс перебирает все строки контракта, для которых должны быть созданы счета, и создает счета.</span><span class="sxs-lookup"><span data-stu-id="386af-150">This workflow goes through all the contract lines that invoices must be created for, and creates the invoices.</span></span> <span data-ttu-id="386af-151">Чтобы определить строки контракта, для которых должны быть созданы счета, рабочий процесс проверяет даты запуска счетов для строк контракта.</span><span class="sxs-lookup"><span data-stu-id="386af-151">To determine the contract lines that invoices must be created for, the workflow looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="386af-152">Если строки контракта, принадлежащие к одному контракту, имеют одинаковую дату запуска счета, транзакции объединяются в один счет с двумя строками счета.</span><span class="sxs-lookup"><span data-stu-id="386af-152">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="386af-153">Если транзакции, для которых требуется создать счета, отсутствуют, счета не создаются.</span><span class="sxs-lookup"><span data-stu-id="386af-153">If there are no transactions to create invoices for, no invoices are created.</span></span>

<span data-ttu-id="386af-154">После завершения работы **ProcessRunner** он вызывает **ProcessRunCaller**, предоставляет время завершения и закрывается.</span><span class="sxs-lookup"><span data-stu-id="386af-154">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="386af-155">**ProcessRunCaller** затем запускает таймер, который работает 24 часа с указанного времени завершения.</span><span class="sxs-lookup"><span data-stu-id="386af-155">**ProcessRunCaller** then starts a timer that runs for 24 hours from the specified end time.</span></span> <span data-ttu-id="386af-156">По завершении работы таймера процесс **ProcessRunCaller** закрывается.</span><span class="sxs-lookup"><span data-stu-id="386af-156">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="386af-157">Задание пакетной обработки для создания счетов — это повторяющееся задание.</span><span class="sxs-lookup"><span data-stu-id="386af-157">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="386af-158">Если это процесс пакетной обработки запускается много раз, создается несколько экземпляров задания, что может вызвать ошибки.</span><span class="sxs-lookup"><span data-stu-id="386af-158">If this batch process is run many times, multiple instances of the job are created and can cause errors.</span></span> <span data-ttu-id="386af-159">Для решения этой проблемы необходимо запустить пакетный процесс только один раз, и заново запускать его следует только в том случае, если он перестал работать.</span><span class="sxs-lookup"><span data-stu-id="386af-159">To work around this issue, start the batch process only one time, and only restart it if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="386af-160">Пакетное выставление счетов запускается только для строк контракта по проекту, которые настроены с помощью графиков счетов.</span><span class="sxs-lookup"><span data-stu-id="386af-160">Batch invoicing only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="386af-161">В строке контракта с методом выставления счетов с фиксированной ценой должны быть настроены вехи.</span><span class="sxs-lookup"><span data-stu-id="386af-161">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="386af-162">Для строки контракта по проекту с методом выставления счетов с учетом времени и материала потребуется настроить расписание счетов на основе даты.</span><span class="sxs-lookup"><span data-stu-id="386af-162">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span> <span data-ttu-id="386af-163">То же самое справедливо для строки контракта на основе проекта.</span><span class="sxs-lookup"><span data-stu-id="386af-163">The same applies to a project-based contract line.</span></span>      
 
### <a name="edit-a-draft-invoice"></a><span data-ttu-id="386af-164">Изменение черновика счета</span><span class="sxs-lookup"><span data-stu-id="386af-164">Edit a draft invoice</span></span>

<span data-ttu-id="386af-165">При создании черновика счета по проекту все транзакции продаж, за которые не выставлены счета, созданные, когда записи времени и расходов были утверждены, выбираются в счет.</span><span class="sxs-lookup"><span data-stu-id="386af-165">When you create a draft project invoice, all unbilled sales transactions that were created when the time and expense entries were approved are pulled onto the invoice.</span></span> <span data-ttu-id="386af-166">Можно внести следующие корректировки, пока счет по-прежнему на этапе черновика:</span><span class="sxs-lookup"><span data-stu-id="386af-166">You can make the following adjustments while the invoice is still in a draft stage:</span></span>

- <span data-ttu-id="386af-167">Удаление или изменение сведений строки счета.</span><span class="sxs-lookup"><span data-stu-id="386af-167">Delete or edit invoice line details.</span></span>
- <span data-ttu-id="386af-168">Изменение и корректировка количества и типа выставления счетов.</span><span class="sxs-lookup"><span data-stu-id="386af-168">Edit and adjust the quantity and billing type.</span></span>
- <span data-ttu-id="386af-169">Прямое добавление времени, расходов, материала и сборов в качестве транзакций по счету.</span><span class="sxs-lookup"><span data-stu-id="386af-169">Directly add time, expense, material, and fees as transactions on the invoice.</span></span> <span data-ttu-id="386af-170">Можно использовать эту функцию, если строка счета сопоставлена строке контракта, которая допускает эти классы транзакций.</span><span class="sxs-lookup"><span data-stu-id="386af-170">You can use this feature if the invoice line is mapped to a contract line that allows for these transaction classes.</span></span>

<span data-ttu-id="386af-171">Выберите **Подтвердить**, чтобы подтвердить счет.</span><span class="sxs-lookup"><span data-stu-id="386af-171">Select **Confirm** to confirm an invoice.</span></span> <span data-ttu-id="386af-172">Это действие подтверждения является односторонним.</span><span class="sxs-lookup"><span data-stu-id="386af-172">This action is a one-way action.</span></span> <span data-ttu-id="386af-173">Если вы выбираете **Подтвердить**, счет становится доступным только для чтения и создает фактические данные продаж с выставленными счетами из каждых сведений строки счета для каждой строки счета.</span><span class="sxs-lookup"><span data-stu-id="386af-173">When you select **Confirm**, the invoice becomes read only and creates billed sales actuals from each invoice line detail for each invoice line.</span></span> <span data-ttu-id="386af-174">Если сведения строки счета ссылаются на фактические данные продаж, за которые не выставлены счета, фактические данные продаж, за которые не выставлены счета, отменяются.</span><span class="sxs-lookup"><span data-stu-id="386af-174">If the invoice line detail references an unbilled sales actual, the unbilled sales actual is reversed.</span></span> <span data-ttu-id="386af-175">Любые сведения строки счета, созданные на основе записи о времени, расходах или использовании материалов, будет ссылаться на фактические продажи без выставленных счетов.</span><span class="sxs-lookup"><span data-stu-id="386af-175">Any invoice line detail that was created from a time, expense, or material usage entry will reference an unbilled sales actual.</span></span> <span data-ttu-id="386af-176">Системы интеграции главной книги могут использовать это сторнирование для сторнирования незавершенного производства (НЗП) для целей бухгалтерского учета.</span><span class="sxs-lookup"><span data-stu-id="386af-176">General ledger integration systems can use this reversal to reverse project work in progress (WIP) for accounting purposes.</span></span>

### <a name="correct-a-confirmed-invoice"></a><span data-ttu-id="386af-177">Исправление утвержденного счета</span><span class="sxs-lookup"><span data-stu-id="386af-177">Correct a confirmed invoice</span></span>

<span data-ttu-id="386af-178">Утвержденные счета можно редактировать.</span><span class="sxs-lookup"><span data-stu-id="386af-178">Confirmed invoices can be edited.</span></span> <span data-ttu-id="386af-179">При исправлении утвержденного счета создается черновик нового корректирующего счета.</span><span class="sxs-lookup"><span data-stu-id="386af-179">When you correct a confirmed invoice, a new draft corrective invoice is created.</span></span> <span data-ttu-id="386af-180">Поскольку предполагается, что требуется реверсировать все транзакции и количества из первоначального счетов, этот корректирующий счет включает все транзакции из первоначального счета, и все количества в нем равны нулю.</span><span class="sxs-lookup"><span data-stu-id="386af-180">Because the assumption is that you want to reverse all the transactions and quantities from the original invoice, this corrective invoice includes all the transactions from the original invoice, and all the quantities on it are zero.</span></span>

<span data-ttu-id="386af-181">Если какие-либо транзакции не требуют исправления, можно удалить их из черновика корректирующего счета.</span><span class="sxs-lookup"><span data-stu-id="386af-181">If there are transactions that don't require correction, you can remove them from the draft corrective invoice.</span></span> <span data-ttu-id="386af-182">Если требуется реверсировать или вернуть только часть количества, можно изменить поле **Количество** в сведениях строки.</span><span class="sxs-lookup"><span data-stu-id="386af-182">If you want to reverse or return only a partial quantity, you can edit the **Quantity** field on the line detail.</span></span> <span data-ttu-id="386af-183">Если открыть сведения строки счета, можно просмотреть первоначальное количество по счету.</span><span class="sxs-lookup"><span data-stu-id="386af-183">If you open the invoice line detail, you can see the original invoice quantity.</span></span> <span data-ttu-id="386af-184">Затем можно изменить текущее количество по счету, чтобы оно было меньше или больше количества по первоначальному счету.</span><span class="sxs-lookup"><span data-stu-id="386af-184">You can then edit the current invoice quantity so that it's less than or more than the original invoice quantity.</span></span>

<span data-ttu-id="386af-185">При утверждении корректирующего счета фактические значения исходных выставленных продаж реверсируется, и создаются новые фактические данные продаж, за которые выставлен счет.</span><span class="sxs-lookup"><span data-stu-id="386af-185">When you confirm a corrective invoice, the original billed sales actual is reversed, and a new billed sales actual is created.</span></span> <span data-ttu-id="386af-186">Если количество было уменьшено, разница вызовет создание новых фактических данных продаж, за которые не выставлен счет.</span><span class="sxs-lookup"><span data-stu-id="386af-186">If the quantity was reduced, the difference will cause a new unbilled sales actual to be created.</span></span> <span data-ttu-id="386af-187">Например, если исходный выставленный счет продажи был за восемь часов, а в сведениях по строке корректирующего счета количество уменьшено до шести часов, исходная строка счета продаж обращается и создаются два новых фактических значения:</span><span class="sxs-lookup"><span data-stu-id="386af-187">For example, if the original billed sale was for eight hours and the corrective invoice line detail has a reduced quantity of six hours, the original billed sales line is reversed and two new actuals are created:</span></span>

- <span data-ttu-id="386af-188">Фактические данные выставленного счета продаж на 6 часов.</span><span class="sxs-lookup"><span data-stu-id="386af-188">A billed sales actual for six hours.</span></span>
- <span data-ttu-id="386af-189">Фактические данные продаж на остальные 2 часа, за которые счет не выставлен.</span><span class="sxs-lookup"><span data-stu-id="386af-189">An unbilled sales actual for the remaining two hours.</span></span> <span data-ttu-id="386af-190">За эту транзакцию можно выставить счет позднее или ее можно пометить как не подлежащую оплате, в зависимости от переговоров с клиентом.</span><span class="sxs-lookup"><span data-stu-id="386af-190">This transaction can be billed later or marked as non-chargeable, depending on the negotiations with the customer.</span></span>



[!INCLUDE[footer-include](../../includes/footer-banner.md)]
