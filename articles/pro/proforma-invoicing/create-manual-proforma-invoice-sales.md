---
title: Счета-проформы по проекту
description: В этой теме содержится информация о счетах-проформах по проекту в Project Operations.
author: rumant
ms.date: 04/06/2021
ms.topic: article
ms.prod: ''
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 1b839c3e40ddcfe1f07b0330a78c42851140d4bf
ms.sourcegitcommit: 40f68387f594180af64a5e5c748b6efa188bd300
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2021
ms.locfileid: "6004052"
---
# <a name="proforma-project-pnvoices"></a>Счета-проформы по проекту

_**Относится к:** развертывание Lite — от сделки до счетов-проформ_

Выставление счетов-проформы по проекту дает руководителям проекта второй уровень утверждения перед созданием счетов для клиентов. Первый уровень утверждения завершается, когда утверждаются записи времени, расходов и материалов, представленные участниками проектной группы.

Dynamics 365 Project Operations Lite Deployment не предназначено для создания счетов для клиентов. В следующем списке показано, почему не могут быть созданы счета:

- Не содержит данные о налогах.
- Невозможно конвертировать другие валюты в валюту выставления счета.
- Невозможно правильно отформатировать счета для печати.

Вместо этого можно использовать финансовую или бухгалтерскую систему для создания счетов для клиентов, которые используют данные из созданных предложений счета.

## <a name="creating-project-invoices"></a>Создание счетов по проекту

Счета проекта можно создавать по отдельности или массово. Можно создавать их вручную или можно настроить таким образом, чтобы они создавались в автоматизированных прогонах.

### <a name="manually-create-project-invoices"></a>Создание счетов проекта вручную 

На странице списка **Контракты по проекту** можно создать счета по проекту отдельно для каждого контракта по проекту или можно создать счета пакетом для нескольких контрактов по проекту.

   - Чтобы создать счет для конкретного контракта проекта, на странице списка **Контракты по проекту** откройте контракт по проекту, затем выберите **Создать счет**.

   Счет создается для всех транзакций для выбранного контракта по проекту с состоянием **Готово к выставлению счета**. Эти транзакции включают в себя время, расходы, материалы, вехи, строки контрактов на основе продуктов и другие строки журнала продаж без выставленных счетов, которые могли быть подтверждены.

Для массового создания счетов:

1. На странице списка **Контракты по проекту** выберите один или несколько контрактов по проекту, для которых необходимо создать счет, затем выберите **Создать счета проекта**.
2. Предупреждение информирует, что может быть задержка до того, как счета будут созданы. Ход выполнения также отображается. Выберите **ОК**, чтобы закрыть окно сообщения.

   Счет создается для всех транзакций по строке контракта с состоянием **Готово к выставлению счета**. Эти транзакции включают в себя время, расходы, материалы, вехи, строки контрактов на основе продуктов и другие строки журнала продаж без выставленных счетов, которые могли быть подтверждены.

3. Для просмотра созданных счетов выберите **Продажи** \> **Выставление счетов** \> **Счета**. Вы увидите по одному счету для каждого контракта по проекту.

### <a name="set-up-automated-creation-of-project-invoices"></a>Настройка автоматизированного создания счетов по проекту 

Выполните следующие шаги для настройки автоматического запуска выставления счетов.

1. Перейдите в раздел **Параметры** \> **Пакетные задания**.
2. Создайте пакетное задание и назовите его **Создание счетов в Project Operations**. Имя пакетного задания должно включать термин "Создание счетов".
3. В поле **Тип задания** выберите **Нет**. По умолчанию для параметров **Частота ежедневно** и **Активно** задано значение **Да**.
4. Выберите **Запустить рабочий процесс**. В диалоговом окне **Поиск в записях** отображаются следующие рабочие процессы:

    - ProcessRunCaller
    - ProcessRunner
    - UpdateRoleUtilization

5. Выберите **ProcessRunCaller**, затем выберите **Добавить**.
6. В следующем диалоговом окне выберите **ОК**. За рабочим процессом **Сон** следует рабочий процесс **Обработка**.

    Можно также выбрать **ProcessRunner** на шаге 5. Затем при выборе **OK** за рабочим процессом **Обработка** следует рабочий процесс **Сон**.

Рабочие процессы **ProcessRunCaller** и **ProcessRunner** создают счета. **ProcessRunCaller** вызывает **ProcessRunner**. Счета создаются рабочим процессом **ProcessRunner**. Этот рабочий процесс перебирает все строки контракта, для которых должны быть созданы счета, и создает счета. Чтобы определить строки контракта, для которых должны быть созданы счета, рабочий процесс проверяет даты запуска счетов для строк контракта. Если строки контракта, принадлежащие к одному контракту, имеют одинаковую дату запуска счета, транзакции объединяются в один счет с двумя строками счета. Если транзакции, для которых требуется создать счета, отсутствуют, счета не создаются.

После завершения работы **ProcessRunner** он вызывает **ProcessRunCaller**, предоставляет время завершения и закрывается. **ProcessRunCaller** затем запускает таймер, который работает 24 часа с указанного времени завершения. По завершении работы таймера процесс **ProcessRunCaller** закрывается.

Задание пакетной обработки для создания счетов — это повторяющееся задание. Если это процесс пакетной обработки запускается много раз, создается несколько экземпляров задания, что может вызвать ошибки. Для решения этой проблемы необходимо запустить пакетный процесс только один раз, и заново запускать его следует только в том случае, если он перестал работать.

> [!NOTE]
> Пакетное выставление счетов запускается только для строк контракта по проекту, которые настроены с помощью графиков счетов. В строке контракта с методом выставления счетов с фиксированной ценой должны быть настроены вехи. Для строки контракта по проекту с методом выставления счетов с учетом времени и материала потребуется настроить расписание счетов на основе даты. То же самое справедливо для строки контракта на основе проекта.      
 
### <a name="edit-a-draft-invoice"></a>Изменение черновика счета

При создании черновика счета по проекту все транзакции продаж, за которые не выставлены счета, созданные, когда записи времени и расходов были утверждены, выбираются в счет. Можно внести следующие корректировки, пока счет по-прежнему на этапе черновика:

- Удаление или изменение сведений строки счета.
- Изменение и корректировка количества и типа выставления счетов.
- Прямое добавление времени, расходов, материала и сборов в качестве транзакций по счету. Можно использовать эту функцию, если строка счета сопоставлена строке контракта, которая допускает эти классы транзакций.

Выберите **Подтвердить**, чтобы подтвердить счет. Это действие подтверждения является односторонним. Если вы выбираете **Подтвердить**, счет становится доступным только для чтения и создает фактические данные продаж с выставленными счетами из каждых сведений строки счета для каждой строки счета. Если сведения строки счета ссылаются на фактические данные продаж, за которые не выставлены счета, фактические данные продаж, за которые не выставлены счета, отменяются. Любые сведения строки счета, созданные на основе записи о времени, расходах или использовании материалов, будет ссылаться на фактические продажи без выставленных счетов. Системы интеграции главной книги могут использовать это сторнирование для сторнирования незавершенного производства (НЗП) для целей бухгалтерского учета.

### <a name="correct-a-confirmed-invoice"></a>Исправление утвержденного счета

Утвержденные счета можно редактировать. При исправлении утвержденного счета создается черновик нового корректирующего счета. Поскольку предполагается, что требуется реверсировать все транзакции и количества из первоначального счетов, этот корректирующий счет включает все транзакции из первоначального счета, и все количества в нем равны нулю.

Если какие-либо транзакции не требуют исправления, можно удалить их из черновика корректирующего счета. Если требуется реверсировать или вернуть только часть количества, можно изменить поле **Количество** в сведениях строки. Если открыть сведения строки счета, можно просмотреть первоначальное количество по счету. Затем можно изменить текущее количество по счету, чтобы оно было меньше или больше количества по первоначальному счету.

При утверждении корректирующего счета фактические значения исходных выставленных продаж реверсируется, и создаются новые фактические данные продаж, за которые выставлен счет. Если количество было уменьшено, разница вызовет создание новых фактических данных продаж, за которые не выставлен счет. Например, если исходный выставленный счет продажи был за восемь часов, а в сведениях по строке корректирующего счета количество уменьшено до шести часов, исходная строка счета продаж обращается и создаются два новых фактических значения:

- Фактические данные выставленного счета продаж на 6 часов.
- Фактические данные продаж на остальные 2 часа, за которые счет не выставлен. За эту транзакцию можно выставить счет позднее или ее можно пометить как не подлежащую оплате, в зависимости от переговоров с клиентом.



[!INCLUDE[footer-include](../../includes/footer-banner.md)]
